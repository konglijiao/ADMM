function val = fun_handle_exp(p)
%Function handle f for a reference solution u

epsi = 0.125;
shift = 0.125;
beta = 0.8;

syms x y;

%u = piecewise(epsi<sqrt((x-0.5)^2+(y-0.5)^2)<epsi+shift,exp(1-1/(1-(sqrt((x-0.5)^2+(y-0.5)^2)-epsi)^2/epsi^2)),(sqrt((x-0.5)^2+(y-0.5)^2)<=epsi),1.0,0.0);

u = exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1);

%gradu = @(x,y) [exp(1.0./((sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2)-1.0./8.0).^2.*6.4e1-1.0)+1.0).*(x.*2.0-1.0).*(sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2)-1.0./8.0).*1.0./((sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2)-1.0./8.0).^2.*6.4e1-1.0).^2.*1.0./sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2).*-6.4e1;exp(1.0./((sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2)-1.0./8.0).^2.*6.4e1-1.0)+1.0).*(y.*2.0-1.0).*(sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2)-1.0./8.0).*1.0./((sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2)-1.0./8.0).^2.*6.4e1-1.0).^2.*1.0./sqrt((x-1.0./2.0).^2+(y-1.0./2.0).^2).*-6.4e1];

d = gradient(u);

normd = norm(d);
divsd = piecewise(epsi<sqrt((x-0.5)^2+(y-0.5)^2)<epsi+shift & normd>beta,divergence(d/normd),0.0);
%L = piecewise(epsi<sqrt((x-0.5)^2+(y-0.5)^2)<epsi+shift,divergence(d),0.0);

%divsd = piecewise(1/64 < (x - 1/2)^2 + (y - 1/2)^2 & ((x - 1/2)^2 + (y - 1/2)^2)^(1/2) < 1/4, (128*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^3*((x - 1/2)^2 + (y - 1/2)^2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) - (exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2)/(2*(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) - (exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2)/(2*(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) - (4*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(1/2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) + (64*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2)- 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) + (128*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^3*((x - 1/2)^2 + (y - 1/2)^2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) + (64*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) + (exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/(2*(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x- 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) + (exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/(2*(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(1/2)) - (exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^2) + (256*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^5*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) + (128*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^6*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) - (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) - (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(8*x - 4)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) - (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^2) + (256*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^5*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) + (128*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^6*((x - 1/2)^2 + (y - 1/2)^2)^(3/2))))/(2*(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(1/2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2+ (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(3/2)) - (exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^2) + (256*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^5*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) + (128*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2)- 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^6*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) - (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^3*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) - (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(8*y - 4)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) - (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(2*y - 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(2*y - 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)^2) + (256*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(2*y - 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^5*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) + (128*exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(2*y - 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^3)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^6*((x - 1/2)^2 + (y - 1/2)^2)^(3/2))))/(2*(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(1/2)*((exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (exp(2/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 2)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)))^(3/2)), 0);
L = piecewise(1/64 < (x - 1/2)^2 + (y - 1/2)^2 & ((x - 1/2)^2 + (y - 1/2)^2)^(1/2) < 1/4, (32*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) - (32*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)) - (32*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)) - (256*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(1/2)) + (32*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8))/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^2*((x - 1/2)^2 + (y - 1/2)^2)^(3/2)) + (8192*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^3*((x - 1/2)^2 + (y - 1/2)^2)) + (4096*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*x - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)) + (8192*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^3*((x - 1/2)^2 + (y - 1/2)^2)) + (4096*exp(1/(64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1) + 1)*(2*y - 1)^2*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2)/((64*(((x - 1/2)^2 + (y - 1/2)^2)^(1/2) - 1/8)^2 - 1)^4*((x - 1/2)^2 + (y - 1/2)^2)), 0);


%sdm = matlabFunction(divsd);
%Lm = matlabFunction(L);

x = p(:,1);
y = p(:,2);


%val = -0.8*(sqrt((x-0.5).^2+(y-0.5).^2)>0.125)'.*(sqrt((x-0.5).^2+(y-0.5).^2)<0.25).*sdm(x,y) - (sqrt((x-0.5).^2+(y-0.5).^2)>0.125)'.*(sqrt((x-0.5).^2+(y-0.5).^2)<0.25).*Lm(x,y);
val = -beta*subs(divsd) - subs(L);

end
